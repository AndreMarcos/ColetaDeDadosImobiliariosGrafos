import networkx as nx
import matplotlib.pyplot as plt
import numpy as np

# ----------------------------------------
# 1. ENTRADA DE DADOS
# ----------------------------------------
# Formato: (u, v, distancia, casas)
dados = [
    (1, 2, 49, 6), (1, 8, 52, 7), (2, 3, 102, 20), (2, 9, 55, 10), (3, 4, 93, 19), (3, 10, 55, 9),
    (4, 5, 53, 9), (4, 11, 53, 6), (5, 6, 58, 7), (5, 12, 50, 5), (6, 7, 92, 8), (6, 13, 48, 7),
    (7, 15, 42, 6), (8, 9, 52, 12), (9, 10, 109, 22), (9, 20, 67, 13), (10, 11, 86, 18), (10, 21, 62, 10),
    (11, 12, 54, 6), (11, 26, 89, 16), (12, 13, 58, 9), (12, 27, 84, 11), (13, 14, 62, 8), (13, 28, 79,5),
    (14, 15, 37, 4), (14, 29, 71, 7), (15, 16, 114, 14), (15, 30, 66, 11), (16, 17, 60, 2), (16, 31, 57, 2),
    (17, 18, 69, 12), (17, 33, 48, 2), (18, 35, 52, 5), (19, 20, 95, 9), (20, 21, 107, 18), (20, 23, 41, 5),
    (21, 25, 36, 4), (22, 23, 93, 13), (22, 36, 83, 7), (23, 24, 58, 9), (23, 37, 84, 14), (24, 25, 54, 14),
    (24, 38, 84, 12), (25, 26, 75, 13), (25, 39, 86, 13), (26, 27, 53, 4), (26, 40, 91, 13), (27, 28, 59, 6),
    (27, 41, 92, 16), (28, 29, 60, 8), (28, 42, 93, 12), (29, 30, 46, 9), (29, 43, 100, 13), (30, 31, 96, 11),
    (30, 44, 100, 16), (31, 32, 52, 4), (31, 45, 103, 16), (32, 33, 45, 0), (32, 46, 111, 8), (33, 34, 45, 3),
    (33, 47, 103, 11), (34, 35, 46, 10), (34, 48, 112, 13), (35, 49, 114, 10), (36, 37, 90, 15), (36, 50, 52, 9),
    (37, 38, 48, 7), (37, 51, 55, 9), (38, 39, 64, 7), (39, 52, 55, 7), (39, 40, 63, 8), (40, 41, 54, 7),
    (40, 53, 54, 9), (41, 42, 59, 11), (41, 54, 59, 7), (42, 43, 54, 7), (42, 55, 60, 8), (43, 44, 42, 4),
    (43, 56, 58, 8), (44, 45, 91, 4), (44, 57, 58, 3), (45, 46, 55, 8), (45, 58, 56, 2), (46, 47, 44, 5),
    (46, 59, 55, 6), (47, 48, 38, 5), (47, 60, 53, 4), (48, 49, 48, 4), (49, 61, 51, 6), (50, 51, 84, 12),
    (50, 62, 66, 8), (51, 52, 112, 16), (51, 63, 64, 7), (52, 53, 54, 10), (52, 65, 60, 9), (53, 54, 54, 6),
    (53, 66, 56, 7), (54, 55, 63, 7), (54, 67, 56, 6), (55, 56, 64, 7), (55, 68, 58, 7), (56, 57, 46, 8),
    (56, 69, 58, 6), (57, 70, 61, 4), (58, 59, 59, 5), (58, 71, 68, 3), (59, 60, 53, 6), (59, 72, 65, 7),
    (60, 61, 88, 4), (60, 73, 62, 5), (61, 74, 63, 4), (62, 63, 79, 13), (62, 75, 62, 13), (63, 64, 68, 10),
    (63, 76, 59, 7), (64, 65, 47, 4), (64, 77, 61, 7), (65, 66, 52, 6), (65, 78, 60, 9), (66, 67, 48, 7),
    (67, 68, 60, 4), (67, 80, 57, 6), (68, 69, 49, 6), (68, 81, 58, 6), (69, 70, 56, 7), (69, 82, 55, 5),
    (70, 71, 63, 4), (71, 72, 69, 5), (71, 83, 50, 2), (72, 73, 55, 6), (72, 84, 53, 6), (73, 74, 92, 16),
    (73, 85, 54, 5), (75, 76, 72, 6), (76, 77, 68, 10), (77, 78, 51, 6), (78, 79, 64, 10), (79, 80, 27, 2),
    (79, 86, 45, 5), (80, 81, 59, 2), (81, 82, 49, 6), (81, 86, 80, 4), (82, 83, 125, 17), (82, 87, 54, 6),
    (83, 84, 70, 8), (83, 88, 55, 6), (84, 85, 53, 6), (84, 89, 94, 8), (85, 90, 66, 7), (90, 91, 95, 9),
    (90, 92, 68, 2)
    
]

# ----------------------------------------
# 2. PARÂMETROS DO PESO
# ----------------------------------------
alpha = 0.6   # importância da distância
beta  = 0.4   # importância da quantidade de casas

# ----------------------------------------
# 3. CONSTRUÇÃO DO GRAFO
# ----------------------------------------
G = nx.Graph()

for u, v, dist, casas in dados:
    G.add_edge(u, v, distancia=dist, casas=casas)

# ----------------------------------------
# 4. NORMALIZAÇÃO
# ----------------------------------------
distancias = np.array([G[u][v]["distancia"] for u, v in G.edges()])
casas = np.array([G[u][v]["casas"] for u, v in G.edges()])

dist_norm = (distancias - distancias.min()) / (distancias.max() - distancias.min())
casas_norm = (casas - casas.min()) / (casas.max() - casas.min())

# aplica no grafo
for (edge, d_norm, c_norm) in zip(G.edges(), dist_norm, casas_norm):
    u, v = edge
    peso = alpha*d_norm + beta*c_norm
    G[u][v]["peso"] = peso

# ----------------------------------------
# 5. DESENHO DO GRAFO
# ----------------------------------------
pos = nx.spring_layout(G, seed=42)

pesos = [G[u][v]["peso"] for u, v in G.edges()]
espessura = [2 + 8*w for w in pesos]  # escala visual
cores = pesos  # coloração baseada no peso

plt.figure(figsize=(15,12))
nx.draw(
    G,
    pos,
    with_labels=True,
    node_size=300,
    edge_color=cores,
    width=espessura,
    edge_cmap=plt.cm.inferno,
    font_size=8
)
plt.title("Grafo com Pesos Normalizados (α={}, β={})".format(alpha, beta))
plt.colorbar(plt.cm.ScalarMappable(cmap="inferno"), label="Peso Normalizado")
plt.show()

# ----------------------------------------
# 6. HISTOGRAMA DOS PESOS
# ----------------------------------------
plt.figure(figsize=(12,6))
plt.hist(pesos, bins=20)
plt.title("Distribuição dos Pesos das Arestas")
plt.xlabel("Peso")
plt.ylabel("Quantidade")
plt.show()
